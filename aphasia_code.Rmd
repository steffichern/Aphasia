---
title: "Aphasia Code"
output: 
  pdf_document: default
  html_document:
    df_print: paged
always_allow_html: true
---

# EDA
We first look at the boxplots for the Cinderella, Cat, Sandwich, Stroke, and Illness task, for the variables % Number of Phrase Repetitions, % Number of Word Revisions, % Number of Phrase Revisions, % Number of Phonological Fragments, % Number of Filled Pauses, and % Number of Whole Word Repetition, across different Aphasia Groups. \
Every variable has 3 boxplots: original, log transformed, and sqrt transformed (to help us determine which transform or no transform is the best at improving interpretability).

```{r}
library(ggplot2)
library(knitr)
cinderella <- read.csv("~/Downloads/36-490 S23/Cinderella.csv")
cat <- read.csv("~/Downloads/36-490 S23/Cat.csv")
sandwich <- read.csv("~/Downloads/36-490 S23/Sandwich.csv")
stroke <- read.csv("~/Downloads/36-490 S23/Stroke.csv")
illness <- read.csv("~/Downloads/36-490 S23/Illness.csv")
stroke_illness <- rbind(stroke, illness)
```

We remove the following Aphasia Groups that have too few number of patients: Transmotor, TransSensory, and Global. There is one group labeled as aphasia from one of the labs, which we have removed as well for clarity. 

```{r}
# Ignoring groups that occur too few times
cinderella <- cinderella[cinderella$Group != "TransMotor", ]
cinderella <- cinderella[cinderella$Group != "TransSensory", ]
cinderella <- cinderella[cinderella$Group != "aphasia", ]
cinderella <- cinderella[cinderella$Group != "Global", ]
cat <- cat[cat$Group != "TransMotor", ]
cat <- cat[cat$Group != "TransSensory", ]
cat <- cat[cat$Group != "aphasia", ]
cat <- cat[cat$Group != "Global", ]
sandwich <- sandwich[sandwich$Group != "TransMotor", ]
sandwich <- sandwich[sandwich$Group != "TransSensory", ]
sandwich <- sandwich[sandwich$Group != "", ]
sandwich <- sandwich[sandwich$Group != "aphasia", ]
sandwich <- sandwich[sandwich$Group != "Global", ]
stroke <- stroke[stroke$Group != "TransMotor", ]
stroke <- stroke[stroke$Group != "TransSensory", ]
stroke <- stroke[stroke$Group != ".", ]
stroke <- stroke[stroke$Group != "aphasia", ]
stroke <- stroke[stroke$Group != "Global", ]
stroke_illness <- stroke_illness[stroke_illness$Group != "TransMotor", ]
stroke_illness <- stroke_illness[stroke_illness$Group != "TransSensory", ]
stroke_illness <- stroke_illness[stroke_illness$Group != ".", ]
stroke_illness <- stroke_illness[stroke_illness$Group != "aphasia", ]
stroke_illness <- stroke_illness[stroke_illness$Group != "Global", ]
```


## Cinderella Task
### % Number of Phrase Repetitions

```{r}
levels = c("control", "Anomic", "Broca", "Conduction", "NotAphasicByWAB", "Wernicke")

ggplot(cinderella, aes(x = factor(Group, levels = levels), y = X._Phrase_repetitions.1, fill = factor(Group, levels = levels))) + 
  geom_boxplot() +
  labs(title = "Distribution of % Phrase Repetitions Given Aphasia Group",
       y = "% # of Phrase Repetitions", x = "Group", fill = "Group") + 
  theme(axis.text.x = element_text(angle = 90, vjust = 0.5, hjust=1))

ggplot(cinderella, aes(x = factor(Group, levels = levels), y = log(X._Phrase_repetitions.1+0.01), fill = factor(Group, levels = levels))) + 
  geom_boxplot() +
  labs(title = "Distribution of % Phrase Repetitions Given Aphasia Group",
       y = "Log (% # of Phrase Repetitions)", x = "Group", fill = "Group") + 
  theme(axis.text.x = element_text(angle = 90, vjust = 0.5, hjust=1))

ggplot(cinderella, aes(x = Group, y = sqrt(X._Phrase_repetitions.1), fill = factor(Group, levels = levels))) + 
  geom_boxplot() +
  labs(title = "Distribution of % Phrase Repetitions Given Aphasia Group",
       y = "Sqrt (% # of Phrase Repetitions)", x = "Group", fill = "Group") + 
  theme(axis.text.x = element_text(angle = 90, vjust = 0.5, hjust=1))
```

### Number of Word Revisions

```{r}
ggplot(cinderella, aes(x = Group, y = X._Word_revisions.1, fill = Group)) + geom_boxplot() +
  labs(title = "Distribution of % Word Revisions Given Aphasia Group",
  y = "% # of Word Revisions", x = "Group", fill = "Group") + 
  theme(axis.text.x = element_text(angle = 90, vjust = 0.5, hjust=1))

ggplot(cinderella, aes(x = factor(Group, levels = levels), y = log(X._Word_revisions.1+0.01), 
                       fill = factor(Group, levels = levels))) + geom_boxplot() +
  labs(title = "Distribution of % Word Revisions Given Aphasia Group",
  y = "Log (% # of Word Revisions)", x = "Group", fill = "Group") + 
  theme(axis.text.x = element_text(angle = 90, vjust = 0.5, hjust=1))

ggplot(cinderella, aes(x = Group, y = sqrt(X._Word_revisions.1), fill = Group)) + geom_boxplot() +
  labs(title = "Distribution of % Word Revisions Given Aphasia Group",
  y = "Sqrt (% # of Word Revisions)", x = "Group", fill = "Group") + 
  theme(axis.text.x = element_text(angle = 90, vjust = 0.5, hjust=1))
```

### Number of Phrase Revisions

```{r}
ggplot(cinderella, aes(x = Group, y = X._Phrase_revisions.1, fill = Group)) + geom_boxplot() +
  labs(title = "Distribution of Phrase Revisions Given Aphasia Group",
  y = "% # of Phrase Revisions", x = "Group", fill = "Group") + 
  theme(axis.text.x = element_text(angle = 90, vjust = 0.5, hjust=1))

ggplot(cinderella, aes(x = factor(Group, levels = levels), y = log(X._Phrase_revisions.1+0.01), fill = factor(Group, levels = levels))) + geom_boxplot() +
  labs(title = "Distribution of Phrase Revisions Given Aphasia Group",
  y = "Log(% # of Phrase Revisions)", x = "Group", fill = "Group") + 
  theme(axis.text.x = element_text(angle = 90, vjust = 0.5, hjust=1))

ggplot(cinderella, aes(x = Group, y = sqrt(X._Phrase_revisions.1), fill = Group)) + geom_boxplot() +
  labs(title = "Distribution of % Phrase Revisions Given Aphasia Group",
  y = "Sqrt(% # of Phrase Revisions)", x = "Group", fill = "Group") + 
  theme(axis.text.x = element_text(angle = 90, vjust = 0.5, hjust=1))
```

### Number of Phonological Fragments

```{r}
ggplot(cinderella, aes(x = Group, y = X._Phonological_fragment.1, fill = Group)) + geom_boxplot() +
  labs(title = "Distribution of % Phonological Fragment Given Aphasia Group",
  y = "% # of Phonological Fragment", x = "Group", fill = "Group") + 
  theme(axis.text.x = element_text(angle = 90, vjust = 0.5, hjust=1))

ggplot(cinderella, aes(x = factor(Group, levels = levels), y = log(X._Phonological_fragment.1+0.01), fill = factor(Group, levels = levels))) + geom_boxplot() +
  labs(title = "Distribution of % Phonological Fragment Given Aphasia Group",
  y = "Log(% # of Phonological Fragment)", x = "Group", fill = "Group") + 
  theme(axis.text.x = element_text(angle = 90, vjust = 0.5, hjust=1))

ggplot(cinderella, aes(x = Group, y = sqrt(X._Phonological_fragment.1), fill = Group)) + geom_boxplot() +
  labs(title = "Distribution of % Phonological Fragment Given Aphasia Group",
  y = "Sqrt(% # of Phonological Fragment)", x = "Group", fill = "Group") + 
  theme(axis.text.x = element_text(angle = 90, vjust = 0.5, hjust=1))
```

### Number of Filled Pauses

```{r}
ggplot(cinderella, aes(x = Group, y = X._Filled_pauses.1, fill = Group)) + geom_boxplot() +
  labs(title = "Distribution of % Filled Pauses Given Aphasia Group",
  y = "% # of Filled Pauses", x = "Group", fill = "Group") + 
  theme(axis.text.x = element_text(angle = 90, vjust = 0.5, hjust=1))

ggplot(cinderella, aes(x = factor(Group, levels = levels), y = log(X._Filled_pauses.1+0.01), fill = factor(Group, levels = levels))) + geom_boxplot() +
  labs(title = "Distribution of % Filled Pauses Given Aphasia Group",
  y = "Log(% # of Filled Pauses)", x = "Group", fill = "Group") + 
  theme(axis.text.x = element_text(angle = 90, vjust = 0.5, hjust=1))

ggplot(cinderella, aes(x = Group, y = sqrt(X._Filled_pauses), fill = Group)) + geom_boxplot() +
  labs(title = "Distribution of % Filled Pauses Given Aphasia Group",
  y = "Sqrt(% # of Filled Pauses)", x = "Group", fill = "Group") + 
  theme(axis.text.x = element_text(angle = 90, vjust = 0.5, hjust=1))
```

### Number of Whole Word Repetition

```{r}
ggplot(cinderella, aes(x = Group, y = X._WWR.1, fill = Group)) + geom_boxplot() +
  labs(title = "Distribution of % Whole Word Repetition Given Aphasia Group",
  y = "% # of Whole Word Repetition", x = "Group", fill = "Group") + 
  theme(axis.text.x = element_text(angle = 90, vjust = 0.5, hjust=1))

ggplot(cinderella, aes(x = factor(Group, levels = levels), y = log(X._WWR.1+0.01), fill = factor(Group, levels = levels))) + geom_boxplot() +
  labs(title = "Distribution of % Whole Word Repetition Given Aphasia Group",
  y = "Log(% # of Whole Word Repetition)", x = "Group", fill = "Group") + 
  theme(axis.text.x = element_text(angle = 90, vjust = 0.5, hjust=1))

ggplot(cinderella, aes(x = Group, y = sqrt(X._WWR.1), fill = Group)) + geom_boxplot() +
  labs(title = "Distribution of % Whole Word Repetition Given Aphasia Group",
  y = "Sqrt(% # of Whole Word Repetition)", x = "Group", fill = "Group") + 
  theme(axis.text.x = element_text(angle = 90, vjust = 0.5, hjust=1))
```

## Cat Task

### Number of Phrase Repetitions

```{r}
ggplot(cat, aes(x = Group, y = X._Phrase_repetitions.1, fill = Group)) + geom_boxplot() +
  labs(title = "Distribution of % Phrase Repetitions Given Aphasia Group",
  y = "% # of Phase Repetitions", x = "Group", fill = "Group") + 
  theme(axis.text.x = element_text(angle = 90, vjust = 0.5, hjust=1))

ggplot(cat, aes(x = Group, y = log(X._Phrase_repetitions.1+0.01), fill = Group)) + geom_boxplot() +
  labs(title = "Distribution of % Phrase Repetitions Given Aphasia Group",
  y = "Log (% # of Phase Repetitions)", x = "Group", fill = "Group") + 
  theme(axis.text.x = element_text(angle = 90, vjust = 0.5, hjust=1))

ggplot(cat, aes(x = Group, y = sqrt(X._Phrase_repetitions.1), fill = Group)) + geom_boxplot() +
  labs(title = "Distribution of % Phrase Repetitions Given Aphasia Group",
  y = "Sqrt (% # of Phase Repetitions)", x = "Group", fill = "Group") + 
  theme(axis.text.x = element_text(angle = 90, vjust = 0.5, hjust=1))
```

### Number of Word Revisions

```{r}
ggplot(cat, aes(x = Group, y = X._Word_revisions.1, fill = Group)) + geom_boxplot() +
  labs(title = "Distribution of % Word Revisions Given Aphasia Group",
  y = "% # of Word Revisions", x = "Group", fill = "Group") + 
  theme(axis.text.x = element_text(angle = 90, vjust = 0.5, hjust=1))

ggplot(cat, aes(x = Group, y = log(X._Word_revisions.1+0.01), fill = Group)) + geom_boxplot() +
  labs(title = "Distribution of % Word Revisions Given Aphasia Group",
  y = "Log (% # of Word Revisions)", x = "Group", fill = "Group") + 
  theme(axis.text.x = element_text(angle = 90, vjust = 0.5, hjust=1))

ggplot(cat, aes(x = Group, y = sqrt(X._Word_revisions.1), fill = Group)) + geom_boxplot() +
  labs(title = "Distribution of % Word Revisions Given Aphasia Group",
  y = "Sqrt (% # of Word Revisions)", x = "Group", fill = "Group") + 
  theme(axis.text.x = element_text(angle = 90, vjust = 0.5, hjust=1))
```

### Number of Phrase Revisions

```{r}
ggplot(cat, aes(x = Group, y = X._Phrase_revisions.1, fill = Group)) + geom_boxplot() +
  labs(title = "Distribution of % Phrase Revisions Given Aphasia Group",
  y = "% # of Phrase Revisions", x = "Group", fill = "Group") + 
  theme(axis.text.x = element_text(angle = 90, vjust = 0.5, hjust=1))

ggplot(cat, aes(x = Group, y = log(X._Phrase_revisions.1+0.01), fill = Group)) + geom_boxplot() +
  labs(title = "Distribution of % Phrase Revisions Given Aphasia Group",
  y = "Log(% # of Phrase Revisions)", x = "Group", fill = "Group") + 
  theme(axis.text.x = element_text(angle = 90, vjust = 0.5, hjust=1))

ggplot(cat, aes(x = Group, y = sqrt(X._Phrase_revisions.1), fill = Group)) + geom_boxplot() +
  labs(title = "Distribution of % Phrase Revisions Given Aphasia Group",
  y = "Sqrt(% # of Phrase Revisions)", x = "Group", fill = "Group") + 
  theme(axis.text.x = element_text(angle = 90, vjust = 0.5, hjust=1))
```

### Number of Phonological Fragments

```{r}
ggplot(cat, aes(x = Group, y = X._Phonological_fragment.1, fill = Group)) + geom_boxplot() +
  labs(title = "Distribution of % Phonological Fragment Given Aphasia Group",
  y = "% # of Phonological Fragment", x = "Group", fill = "Group") + 
  theme(axis.text.x = element_text(angle = 90, vjust = 0.5, hjust=1))

ggplot(cat, aes(x = Group, y = log(X._Phonological_fragment.1+0.01), fill = Group)) + geom_boxplot() +
  labs(title = "Distribution of % Phonological Fragment Given Aphasia Group",
  y = "Log(% # of Phonological Fragment)", x = "Group", fill = "Group") + 
  theme(axis.text.x = element_text(angle = 90, vjust = 0.5, hjust=1))

ggplot(cat, aes(x = Group, y = sqrt(X._Phonological_fragment.1), fill = Group)) + geom_boxplot() +
  labs(title = "Distribution of % Phonological Fragment Given Aphasia Group",
  y = "Sqrt(% # of Phonological Fragment)", x = "Group", fill = "Group") + 
  theme(axis.text.x = element_text(angle = 90, vjust = 0.5, hjust=1))
```

### Number of Filled Pauses

```{r}
ggplot(cat, aes(x = Group, y = X._Filled_pauses.1, fill = Group)) + geom_boxplot() +
  labs(title = "Distribution of % Filled Pauses Given Aphasia Group",
  y = "% # of Filled Pauses", x = "Group", fill = "Group") + 
  theme(axis.text.x = element_text(angle = 90, vjust = 0.5, hjust=1))

ggplot(cat, aes(x = Group, y = log(X._Filled_pauses.1+0.01), fill = Group)) + geom_boxplot() +
  labs(title = "Distribution of % Filled Pauses Given Aphasia Group",
  y = "Log(% # of Filled Pauses)", x = "Group", fill = "Group") + 
  theme(axis.text.x = element_text(angle = 90, vjust = 0.5, hjust=1))

ggplot(cat, aes(x = Group, y = sqrt(X._Filled_pauses.1), fill = Group)) + geom_boxplot() +
  labs(title = "Distribution of % Filled Pauses Given Aphasia Group",
  y = "Sqrt(% # of Filled Pauses)", x = "Group", fill = "Group") + 
  theme(axis.text.x = element_text(angle = 90, vjust = 0.5, hjust=1))
```

### Number of Whole Word Repetition

```{r}
ggplot(cat, aes(x = Group, y = X._WWR.1, fill = Group)) + geom_boxplot() +
  labs(title = "Distribution of % Whole Word Repetition Given Aphasia Group",
  y = "% # of Whole Word Repetition", x = "Group", fill = "Group") + 
  theme(axis.text.x = element_text(angle = 90, vjust = 0.5, hjust=1))

ggplot(cat, aes(x = Group, y = log(X._WWR.1+0.01), fill = Group)) + geom_boxplot() +
  labs(title = "Distribution of % Whole Word Repetition Given Aphasia Group",
  y = "Log(% # of Whole Word Repetition)", x = "Group", fill = "Group") + 
  theme(axis.text.x = element_text(angle = 90, vjust = 0.5, hjust=1))

ggplot(cat, aes(x = Group, y = sqrt(X._WWR.1), fill = Group)) + geom_boxplot() +
  labs(title = "Distribution of % Whole Word Repetition Given Aphasia Group",
  y = "Sqrt(% # of Whole Word Repetition)", x = "Group", fill = "Group") + 
  theme(axis.text.x = element_text(angle = 90, vjust = 0.5, hjust=1))
```

## Sandwich Task

### Number of Phrase Repetitions

```{r}
ggplot(sandwich, aes(x = Group, y = X._Phrase_repetitions.1, fill = Group)) + geom_boxplot() +
  labs(title = "Distribution of % Phrase Repetitions Given Aphasia Group",
  y = "% # of Phase Repetitions", x = "Group", fill = "Group") + 
  theme(axis.text.x = element_text(angle = 90, vjust = 0.5, hjust=1))

ggplot(sandwich, aes(x = Group, y = log(X._Phrase_repetitions.1+0.01), fill = Group)) + geom_boxplot() +
  labs(title = "Distribution of % Phrase Repetitions Given Aphasia Group",
  y = "Log (% # of Phase Repetitions)", x = "Group", fill = "Group") + 
  theme(axis.text.x = element_text(angle = 90, vjust = 0.5, hjust=1))

ggplot(sandwich, aes(x = Group, y = sqrt(X._Phrase_repetitions.1), fill = Group)) + geom_boxplot() +
  labs(title = "Distribution of % Phrase Repetitions Given Aphasia Group",
  y = "Sqrt (% # of Phase Repetitions)", x = "Group", fill = "Group") + 
  theme(axis.text.x = element_text(angle = 90, vjust = 0.5, hjust=1))
```

### Number of Word Revisions

```{r}
ggplot(sandwich, aes(x = Group, y = X._Word_revisions.1, fill = Group)) + geom_boxplot() +
  labs(title = "Distribution of % Word Revisions Given Aphasia Group",
  y = "% # of Word Revisions", x = "Group", fill = "Group") + 
  theme(axis.text.x = element_text(angle = 90, vjust = 0.5, hjust=1))

ggplot(sandwich, aes(x = Group, y = log(X._Word_revisions.1+0.01), fill = Group)) + geom_boxplot() +
  labs(title = "Distribution of % Word Revisions Given Aphasia Group",
  y = "Log (% # of Word Revisions)", x = "Group", fill = "Group") + 
  theme(axis.text.x = element_text(angle = 90, vjust = 0.5, hjust=1))

ggplot(sandwich, aes(x = Group, y = sqrt(X._Word_revisions.1), fill = Group)) + geom_boxplot() +
  labs(title = "Distribution of % Word Revisions Given Aphasia Group",
  y = "Sqrt (% # of Word Revisions)", x = "Group", fill = "Group") + 
  theme(axis.text.x = element_text(angle = 90, vjust = 0.5, hjust=1))
```

### Number of Phrase Revisions

```{r}
ggplot(sandwich, aes(x = Group, y = X._Phrase_revisions.1, fill = Group)) + geom_boxplot() +
  labs(title = "Distribution of % Phrase Revisions Given Aphasia Group",
  y = "% # of Phrase Revisions", x = "Group", fill = "Group") + 
  theme(axis.text.x = element_text(angle = 90, vjust = 0.5, hjust=1))

ggplot(sandwich, aes(x = Group, y = log(X._Phrase_revisions.1+0.01), fill = Group)) + geom_boxplot() +
  labs(title = "Distribution of % Phrase Revisions Given Aphasia Group",
  y = "Log(% # of Phrase Revisions)", x = "Group", fill = "Group") + 
  theme(axis.text.x = element_text(angle = 90, vjust = 0.5, hjust=1))

ggplot(sandwich, aes(x = Group, y = sqrt(X._Phrase_revisions.1), fill = Group)) + geom_boxplot() +
  labs(title = "Distribution of % Phrase Revisions Given Aphasia Group",
  y = "Sqrt(% # of Phrase Revisions)", x = "Group", fill = "Group") + 
  theme(axis.text.x = element_text(angle = 90, vjust = 0.5, hjust=1))
```

### Number of Phonological Fragments

```{r}
ggplot(sandwich, aes(x = Group, y = X._Phonological_fragment.1, fill = Group)) + geom_boxplot() +
  labs(title = "Distribution of % Phonological Fragment Given Aphasia Group",
  y = "% # of Phonological Fragment", x = "Group", fill = "Group") + 
  theme(axis.text.x = element_text(angle = 90, vjust = 0.5, hjust=1))

ggplot(sandwich, aes(x = Group, y = log(X._Phonological_fragment.1+0.01), fill = Group)) + geom_boxplot() +
  labs(title = "Distribution of % Phonological Fragment Given Aphasia Group",
  y = "Log(% # of Phonological Fragment)", x = "Group", fill = "Group") + 
  theme(axis.text.x = element_text(angle = 90, vjust = 0.5, hjust=1))

ggplot(sandwich, aes(x = Group, y = sqrt(X._Phonological_fragment.1), fill = Group)) + geom_boxplot() +
  labs(title = "Distribution of % Phonological Fragment Given Aphasia Group",
  y = "Sqrt(% # of Phonological Fragment)", x = "Group", fill = "Group") + 
  theme(axis.text.x = element_text(angle = 90, vjust = 0.5, hjust=1))
```

### Number of Filled Pauses

```{r}
ggplot(sandwich, aes(x = Group, y = X._Filled_pauses.1, fill = Group)) + geom_boxplot() +
  labs(title = "Distribution of % Filled Pauses Given Aphasia Group",
  y = "% # of Filled Pauses", x = "Group", fill = "Group") + 
  theme(axis.text.x = element_text(angle = 90, vjust = 0.5, hjust=1))

ggplot(sandwich, aes(x = Group, y = log(X._Filled_pauses.1+0.01), fill = Group)) + geom_boxplot() +
  labs(title = "Distribution of % Filled Pauses Given Aphasia Group",
  y = "Log(% # of Filled Pauses)", x = "Group", fill = "Group") + 
  theme(axis.text.x = element_text(angle = 90, vjust = 0.5, hjust=1))

ggplot(sandwich, aes(x = Group, y = sqrt(X._Filled_pauses.1), fill = Group)) + geom_boxplot() +
  labs(title = "Distribution of % Filled Pauses Given Aphasia Group",
  y = "Sqrt(% # of Filled Pauses)", x = "Group", fill = "Group") + 
  theme(axis.text.x = element_text(angle = 90, vjust = 0.5, hjust=1))
```

### Number of Whole Word Repetition

```{r}
ggplot(sandwich, aes(x = Group, y = X._WWR.1, fill = Group)) + geom_boxplot() +
  labs(title = "Distribution of % Whole Word Repetition Given Aphasia Group",
  y = "% # of Whole Word Repetition", x = "Group", fill = "Group") + 
  theme(axis.text.x = element_text(angle = 90, vjust = 0.5, hjust=1))

ggplot(sandwich, aes(x = Group, y = log(X._WWR.1+0.01), fill = Group)) + geom_boxplot() +
  labs(title = "Distribution of % Whole Word Repetition Given Aphasia Group",
  y = "Log(% # of Whole Word Repetition)", x = "Group", fill = "Group") + 
  theme(axis.text.x = element_text(angle = 90, vjust = 0.5, hjust=1))

ggplot(sandwich, aes(x = Group, y = sqrt(X._WWR.1), fill = Group)) + geom_boxplot() +
  labs(title = "Distribution of % Whole Word Repetition Given Aphasia Group",
  y = "Sqrt(% # of Whole Word Repetition)", x = "Group", fill = "Group") + 
  theme(axis.text.x = element_text(angle = 90, vjust = 0.5, hjust=1))
```

## Stroke Task

### Number of Phrase Repetitions

```{r}
ggplot(stroke, aes(x = Group, y = X._Phrase_repetitions.1, fill = Group)) + geom_boxplot() +
  labs(title = "Distribution of % Phrase Repetitions Given Aphasia Group",
  y = "% # of Phase Repetitions", x = "Group", fill = "Group") + 
  theme(axis.text.x = element_text(angle = 90, vjust = 0.5, hjust=1))

ggplot(stroke, aes(x = Group, y = log(X._Phrase_repetitions.1), fill = Group)) + geom_boxplot() +
  labs(title = "Distribution of % Phrase Repetitions Given Aphasia Group",
  y = "Log (% # of Phase Repetitions)", x = "Group", fill = "Group") + 
  theme(axis.text.x = element_text(angle = 90, vjust = 0.5, hjust=1))

ggplot(stroke, aes(x = Group, y = sqrt(X._Phrase_repetitions), fill = Group)) + geom_boxplot() +
  labs(title = "Distribution of % Phrase Repetitions Given Aphasia Group",
  y = "Sqrt (% # of Phase Repetitions)", x = "Group", fill = "Group") + 
  theme(axis.text.x = element_text(angle = 90, vjust = 0.5, hjust=1))
```

### Number of Word Revisions

```{r}
ggplot(stroke, aes(x = Group, y = X._Word_revisions, fill = Group)) + geom_boxplot() +
  labs(title = "Distribution of Word Revisions Given Aphasia Group",
  y = "# of Word Revisions", x = "Group", fill = "Group") + 
  theme(axis.text.x = element_text(angle = 90, vjust = 0.5, hjust=1))

ggplot(stroke, aes(x = Group, y = log(X._Word_revisions), fill = Group)) + geom_boxplot() +
  labs(title = "Distribution of Word Revisions Given Aphasia Group",
  y = "Log (# of Word Revisions)", x = "Group", fill = "Group") + 
  theme(axis.text.x = element_text(angle = 90, vjust = 0.5, hjust=1))

ggplot(stroke, aes(x = Group, y = sqrt(X._Word_revisions), fill = Group)) + geom_boxplot() +
  labs(title = "Distribution of Word Revisions Given Aphasia Group",
  y = "Sqrt (# of Word Revisions)", x = "Group", fill = "Group") + 
  theme(axis.text.x = element_text(angle = 90, vjust = 0.5, hjust=1))
```

### Number of Phrase Revisions

```{r}
ggplot(stroke, aes(x = Group, y = X._Phrase_revisions, fill = Group)) + geom_boxplot() +
  labs(title = "Distribution of Phrase Revisions Given Aphasia Group",
  y = "# of Phrase Revisions", x = "Group", fill = "Group") + 
  theme(axis.text.x = element_text(angle = 90, vjust = 0.5, hjust=1))

ggplot(stroke, aes(x = Group, y = log(X._Phrase_revisions), fill = Group)) + geom_boxplot() +
  labs(title = "Distribution of Phrase Revisions Given Aphasia Group",
  y = "Log(# of Phrase Revisions)", x = "Group", fill = "Group") + 
  theme(axis.text.x = element_text(angle = 90, vjust = 0.5, hjust=1))

ggplot(stroke, aes(x = Group, y = sqrt(X._Phrase_revisions), fill = Group)) + geom_boxplot() +
  labs(title = "Distribution of Phrase Revisions Given Aphasia Group",
  y = "Sqrt(# of Phrase Revisions)", x = "Group", fill = "Group") + 
  theme(axis.text.x = element_text(angle = 90, vjust = 0.5, hjust=1))
```

### Number of Phonological Fragments

```{r}
ggplot(stroke, aes(x = Group, y = X._Phonological_fragment, fill = Group)) + geom_boxplot() +
  labs(title = "Distribution of Phonological Fragment Given Aphasia Group",
  y = "# of Phonological Fragment", x = "Group", fill = "Group") + 
  theme(axis.text.x = element_text(angle = 90, vjust = 0.5, hjust=1))

ggplot(stroke, aes(x = Group, y = log(X._Phonological_fragment), fill = Group)) + geom_boxplot() +
  labs(title = "Distribution of Phonological Fragment Given Aphasia Group",
  y = "Log(# of Phonological Fragment)", x = "Group", fill = "Group") + 
  theme(axis.text.x = element_text(angle = 90, vjust = 0.5, hjust=1))

ggplot(stroke, aes(x = Group, y = sqrt(X._Phonological_fragment), fill = Group)) + geom_boxplot() +
  labs(title = "Distribution of Phonological Fragment Given Aphasia Group",
  y = "Sqrt(# of Phonological Fragment)", x = "Group", fill = "Group") + 
  theme(axis.text.x = element_text(angle = 90, vjust = 0.5, hjust=1))
```


### Number of Filled Pauses

```{r}
ggplot(stroke, aes(x = Group, y = X._Filled_pauses, fill = Group)) + geom_boxplot() +
  labs(title = "Distribution of Filled Pauses Given Aphasia Group",
  y = "# of Filled Pauses", x = "Group", fill = "Group") + 
  theme(axis.text.x = element_text(angle = 90, vjust = 0.5, hjust=1))

ggplot(stroke, aes(x = Group, y = log(X._Filled_pauses), fill = Group)) + geom_boxplot() +
  labs(title = "Distribution of Filled Pauses Given Aphasia Group",
  y = "Log(# of Filled Pauses)", x = "Group", fill = "Group") + 
  theme(axis.text.x = element_text(angle = 90, vjust = 0.5, hjust=1))

ggplot(stroke, aes(x = Group, y = sqrt(X._Filled_pauses), fill = Group)) + geom_boxplot() +
  labs(title = "Distribution of Filled Pauses Given Aphasia Group",
  y = "Sqrt(# of Filled Pauses)", x = "Group", fill = "Group") + 
  theme(axis.text.x = element_text(angle = 90, vjust = 0.5, hjust=1))
```

### Number of Whole Word Repetition

```{r}
ggplot(stroke, aes(x = Group, y = X._WWR, fill = Group)) + geom_boxplot() +
  labs(title = "Distribution of Whole Word Repetition Given Aphasia Group",
  y = "# of Whole Word Repetition", x = "Group", fill = "Group") + 
  theme(axis.text.x = element_text(angle = 90, vjust = 0.5, hjust=1))

ggplot(stroke, aes(x = Group, y = log(X._WWR), fill = Group)) + geom_boxplot() +
  labs(title = "Distribution of Whole Word Repetition Given Aphasia Group",
  y = "Log(# of Whole Word Repetition)", x = "Group", fill = "Group") + 
  theme(axis.text.x = element_text(angle = 90, vjust = 0.5, hjust=1))

ggplot(stroke, aes(x = Group, y = sqrt(X._WWR), fill = Group)) + geom_boxplot() +
  labs(title = "Distribution of Whole Word Repetition Given Aphasia Group",
  y = "Sqrt(# of Whole Word Repetition)", x = "Group", fill = "Group") + 
  theme(axis.text.x = element_text(angle = 90, vjust = 0.5, hjust=1))
```


## Illness Task

### Number of Phrase Repetitions

```{r}
ggplot(illness, aes(x = Group, y = X._Phrase_repetitions, fill = Group)) + geom_boxplot() +
  labs(title = "Distribution of Phrase Repetitions Given Aphasia Group",
  y = "# of Phase Repetitions", x = "Group", fill = "Group") + 
  theme(axis.text.x = element_text(angle = 90, vjust = 0.5, hjust=1))

ggplot(illness, aes(x = Group, y = log(X._Phrase_repetitions), fill = Group)) + geom_boxplot() +
  labs(title = "Distribution of Phrase Repetitions Given Aphasia Group",
  y = "Log (# of Phase Repetitions)", x = "Group", fill = "Group") + 
  theme(axis.text.x = element_text(angle = 90, vjust = 0.5, hjust=1))

ggplot(illness, aes(x = Group, y = sqrt(X._Phrase_repetitions), fill = Group)) + geom_boxplot() +
  labs(title = "Distribution of Phrase Repetitions Given Aphasia Group",
  y = "Sqrt (# of Phase Repetitions)", x = "Group", fill = "Group") + 
  theme(axis.text.x = element_text(angle = 90, vjust = 0.5, hjust=1))
```

### Number of Word Revisions

```{r}
ggplot(illness, aes(x = Group, y = X._Word_revisions, fill = Group)) + geom_boxplot() +
  labs(title = "Distribution of Word Revisions Given Aphasia Group",
  y = "# of Word Revisions", x = "Group", fill = "Group") + 
  theme(axis.text.x = element_text(angle = 90, vjust = 0.5, hjust=1))

ggplot(illness, aes(x = Group, y = log(X._Word_revisions), fill = Group)) + geom_boxplot() +
  labs(title = "Distribution of Word Revisions Given Aphasia Group",
  y = "Log (# of Word Revisions)", x = "Group", fill = "Group") + 
  theme(axis.text.x = element_text(angle = 90, vjust = 0.5, hjust=1))

ggplot(illness, aes(x = Group, y = sqrt(X._Word_revisions), fill = Group)) + geom_boxplot() +
  labs(title = "Distribution of Word Revisions Given Aphasia Group",
  y = "Sqrt (# of Word Revisions)", x = "Group", fill = "Group") + 
  theme(axis.text.x = element_text(angle = 90, vjust = 0.5, hjust=1))
```

### Number of Phrase Revisions

```{r}
ggplot(illness, aes(x = Group, y = X._Phrase_revisions, fill = Group)) + geom_boxplot() +
  labs(title = "Distribution of Phrase Revisions Given Aphasia Group",
  y = "# of Phrase Revisions", x = "Group", fill = "Group") + 
  theme(axis.text.x = element_text(angle = 90, vjust = 0.5, hjust=1))

ggplot(illness, aes(x = Group, y = log(X._Phrase_revisions), fill = Group)) + geom_boxplot() +
  labs(title = "Distribution of Phrase Revisions Given Aphasia Group",
  y = "Log(# of Phrase Revisions)", x = "Group", fill = "Group") + 
  theme(axis.text.x = element_text(angle = 90, vjust = 0.5, hjust=1))

ggplot(illness, aes(x = Group, y = sqrt(X._Phrase_revisions), fill = Group)) + geom_boxplot() +
  labs(title = "Distribution of Phrase Revisions Given Aphasia Group",
  y = "Sqrt(# of Phrase Revisions)", x = "Group", fill = "Group") + 
  theme(axis.text.x = element_text(angle = 90, vjust = 0.5, hjust=1))
```

### Number of Phonological Fragments

```{r}
ggplot(illness, aes(x = Group, y = X._Phonological_fragment, fill = Group)) + geom_boxplot() +
  labs(title = "Distribution of Phonological Fragment Given Aphasia Group",
  y = "# of Phonological Fragment", x = "Group", fill = "Group") + 
  theme(axis.text.x = element_text(angle = 90, vjust = 0.5, hjust=1))

ggplot(illness, aes(x = Group, y = log(X._Phonological_fragment), fill = Group)) + geom_boxplot() +
  labs(title = "Distribution of Phonological Fragment Given Aphasia Group",
  y = "Log(# of Phonological Fragment)", x = "Group", fill = "Group") + 
  theme(axis.text.x = element_text(angle = 90, vjust = 0.5, hjust=1))

ggplot(illness, aes(x = Group, y = sqrt(X._Phonological_fragment), fill = Group)) + geom_boxplot() +
  labs(title = "Distribution of Phonological Fragment Given Aphasia Group",
  y = "Sqrt(# of Phonological Fragment)", x = "Group", fill = "Group") + 
  theme(axis.text.x = element_text(angle = 90, vjust = 0.5, hjust=1))
```


### Number of Filled Pauses

```{r}
ggplot(illness, aes(x = Group, y = X._Filled_pauses, fill = Group)) + geom_boxplot() +
  labs(title = "Distribution of Filled Pauses Given Aphasia Group",
  y = "# of Filled Pauses", x = "Group", fill = "Group") + 
  theme(axis.text.x = element_text(angle = 90, vjust = 0.5, hjust=1))

ggplot(illness, aes(x = Group, y = log(X._Filled_pauses), fill = Group)) + geom_boxplot() +
  labs(title = "Distribution of Filled Pauses Given Aphasia Group",
  y = "Log(# of Filled Pauses)", x = "Group", fill = "Group") + 
  theme(axis.text.x = element_text(angle = 90, vjust = 0.5, hjust=1))

ggplot(illness, aes(x = Group, y = sqrt(X._Filled_pauses), fill = Group)) + geom_boxplot() +
  labs(title = "Distribution of Filled Pauses Given Aphasia Group",
  y = "Sqrt(# of Filled Pauses)", x = "Group", fill = "Group") + 
  theme(axis.text.x = element_text(angle = 90, vjust = 0.5, hjust=1))
```

### Number of Whole Word Repetition

```{r}
ggplot(illness, aes(x = Group, y = X._WWR, fill = Group)) + geom_boxplot() +
  labs(title = "Distribution of Whole Word Repetition Given Aphasia Group",
  y = "# of Whole Word Repetition", x = "Group", fill = "Group") + 
  theme(axis.text.x = element_text(angle = 90, vjust = 0.5, hjust=1))

ggplot(illness, aes(x = Group, y = log(X._WWR), fill = Group)) + geom_boxplot() +
  labs(title = "Distribution of Whole Word Repetition Given Aphasia Group",
  y = "Log(# of Whole Word Repetition)", x = "Group", fill = "Group") + 
  theme(axis.text.x = element_text(angle = 90, vjust = 0.5, hjust=1))

ggplot(illness, aes(x = Group, y = sqrt(X._WWR), fill = Group)) + geom_boxplot() +
  labs(title = "Distribution of Whole Word Repetition Given Aphasia Group",
  y = "Sqrt(# of Whole Word Repetition)", x = "Group", fill = "Group") + 
  theme(axis.text.x = element_text(angle = 90, vjust = 0.5, hjust=1))
```

We also plotted boxplots of combining the Stroke and Illness tasks, since people are asked to either explain their Stroke story (for people wiht Aphasia), or explain any Illness they had in the past (for people without Aphasia)

## Combining Stroke and Illness Task
### Number of Phrase Repetitions

```{r}
ggplot(stroke_illness, aes(x = Group, y = X._Phrase_repetitions.1, fill = Group)) + geom_boxplot() +
  labs(title = "Distribution of % Phrase Repetitions Given Aphasia Group",
  y = "% # of Phase Repetitions", x = "Group", fill = "Group") + 
  theme(axis.text.x = element_text(angle = 90, vjust = 0.5, hjust=1))

ggplot(stroke_illness, aes(x = Group, y = log(X._Phrase_repetitions.1+0.01), fill = Group)) + geom_boxplot() +
  labs(title = "Distribution of % Phrase Repetitions Given Aphasia Group",
  y = "Log (% # of Phase Repetitions)", x = "Group", fill = "Group") + 
  theme(axis.text.x = element_text(angle = 90, vjust = 0.5, hjust=1))

ggplot(stroke_illness, aes(x = Group, y = sqrt(X._Phrase_repetitions.1), fill = Group)) + geom_boxplot() +
  labs(title = "Distribution of % Phrase Repetitions Given Aphasia Group",
  y = "Sqrt (% # of Phase Repetitions)", x = "Group", fill = "Group") + 
  theme(axis.text.x = element_text(angle = 90, vjust = 0.5, hjust=1))
```

### Number of Word Revisions

```{r}
ggplot(stroke_illness, aes(x = Group, y = X._Word_revisions.1, fill = Group)) + geom_boxplot() +
  labs(title = "Distribution of % Word Revisions Given Aphasia Group",
  y = "% # of Word Revisions", x = "Group", fill = "Group") + 
  theme(axis.text.x = element_text(angle = 90, vjust = 0.5, hjust=1))

ggplot(stroke_illness, aes(x = Group, y = log(X._Word_revisions.1+0.01), fill = Group)) + 
  geom_boxplot() + labs(title = "Distribution of % Word Revisions Given Aphasia Group",
  y = "Log (% # of Word Revisions)", x = "Group", fill = "Group") + 
  theme(axis.text.x = element_text(angle = 90, vjust = 0.5, hjust=1))

ggplot(stroke_illness, aes(x = Group, y = sqrt(X._Word_revisions.1), fill = Group)) + 
  geom_boxplot() + labs(title = "Distribution of % Word Revisions Given Aphasia Group",
  y = "Sqrt (% # of Word Revisions)", x = "Group", fill = "Group") + 
  theme(axis.text.x = element_text(angle = 90, vjust = 0.5, hjust=1))
```


## Number of Phrase Revisions

```{r}
ggplot(stroke_illness, aes(x = Group, y = X._Phrase_revisions.1, fill = Group)) + geom_boxplot() +
  labs(title = "Distribution of % Phrase Revisions Given Aphasia Group",
  y = "% # of Phrase Revisions", x = "Group", fill = "Group") + 
  theme(axis.text.x = element_text(angle = 90, vjust = 0.5, hjust=1))

ggplot(stroke_illness, aes(x = Group, y = log(X._Phrase_revisions.1+0.01), fill = Group)) +
  geom_boxplot() + labs(title = "Distribution of % Phrase Revisions Given Aphasia Group",
  y = "Log(% # of Phrase Revisions)", x = "Group", fill = "Group") + 
  theme(axis.text.x = element_text(angle = 90, vjust = 0.5, hjust=1))

ggplot(stroke_illness, aes(x = Group, y = sqrt(X._Phrase_revisions.1), fill = Group)) + 
  geom_boxplot() + labs(title = "Distribution of % Phrase Revisions Given Aphasia Group",
  y = "Sqrt(% # of Phrase Revisions)", x = "Group", fill = "Group") + 
  theme(axis.text.x = element_text(angle = 90, vjust = 0.5, hjust=1))
```

## Number of Phonological Fragments

```{r}
ggplot(stroke_illness, aes(x = Group, y = X._Phonological_fragment.1, fill = Group)) + 
  geom_boxplot() + labs(title = "Distribution of % Phonological Fragment Given Aphasia Group",
  y = "% # of Phonological Fragment", x = "Group", fill = "Group") + 
  theme(axis.text.x = element_text(angle = 90, vjust = 0.5, hjust=1))

ggplot(stroke_illness, aes(x = Group, y = log(X._Phonological_fragment.1+0.01), fill = Group)) + 
  geom_boxplot() + labs(title = "Distribution of % Phonological Fragment Given Aphasia Group",
  y = "Log(% # of Phonological Fragment)", x = "Group", fill = "Group") + 
  theme(axis.text.x = element_text(angle = 90, vjust = 0.5, hjust=1))

ggplot(stroke_illness, aes(x = Group, y = sqrt(X._Phonological_fragment.1), fill = Group)) + 
  geom_boxplot() + labs(title = "Distribution of % Phonological Fragment Given Aphasia Group",
  y = "Sqrt(% # of Phonological Fragment)", x = "Group", fill = "Group") + 
  theme(axis.text.x = element_text(angle = 90, vjust = 0.5, hjust=1))
```

## Number of Filled Pauses

```{r}
ggplot(stroke_illness, aes(x = Group, y = X._Filled_pauses.1, fill = Group)) + geom_boxplot() +
  labs(title = "Distribution of % Filled Pauses Given Aphasia Group",
  y = "% # of Filled Pauses", x = "Group", fill = "Group") + 
  theme(axis.text.x = element_text(angle = 90, vjust = 0.5, hjust=1))

ggplot(stroke_illness, aes(x = Group, y = log(X._Filled_pauses.1+0.01), fill = Group)) + geom_boxplot() +
  labs(title = "Distribution of % Filled Pauses Given Aphasia Group",
  y = "Log(% # of Filled Pauses)", x = "Group", fill = "Group") + 
  theme(axis.text.x = element_text(angle = 90, vjust = 0.5, hjust=1))

ggplot(stroke_illness, aes(x = Group, y = sqrt(X._Filled_pauses.1), fill = Group)) + 
  geom_boxplot() + labs(title = "Distribution of % Filled Pauses Given Aphasia Group",
  y = "Sqrt(% # of Filled Pauses)", x = "Group", fill = "Group") + 
  theme(axis.text.x = element_text(angle = 90, vjust = 0.5, hjust=1))
```

## Number of Whole Word Repetition

```{r}
ggplot(stroke_illness, aes(x = Group, y = X._WWR.1, fill = Group)) + geom_boxplot() +
  labs(title = "Distribution of % Whole Word Repetition Given Aphasia Group",
  y = "% # of Whole Word Repetition", x = "Group", fill = "Group") + 
  theme(axis.text.x = element_text(angle = 90, vjust = 0.5, hjust=1))

ggplot(stroke_illness, aes(x = Group, y = log(X._WWR.1+0.01), fill = Group)) + geom_boxplot() +
  labs(title = "Distribution of % Whole Word Repetition Given Aphasia Group",
  y = "Log(% # of Whole Word Repetition)", x = "Group", fill = "Group") + 
  theme(axis.text.x = element_text(angle = 90, vjust = 0.5, hjust=1))

ggplot(stroke_illness, aes(x = Group, y = sqrt(X._WWR.1), fill = Group)) + geom_boxplot() +
  labs(title = "Distribution of % Whole Word Repetition Given Aphasia Group",
  y = "Sqrt(% # of Whole Word Repetition)", x = "Group", fill = "Group") + 
  theme(axis.text.x = element_text(angle = 90, vjust = 0.5, hjust=1))
```

# Results
We perform PCA on the Cinderella task:

```{r}
variables = c("Age.Month.", "Custom_field", "mor_Utts", "mor_Words", "words_min", "X._WWR.1", "X._Phonological_fragment.1", "X._Phrase_repetitions.1", "X._Word_revisions.1", "X._Phrase_revisions.1", "X._Filled_pauses.1", "IW_Dur.Utt_dur", "No_Switch_Dur.._No_Switch", "Group")
c_sub = subset(cinderella, select = variables)
colnames(c_sub) = c("Age", "AQ_score", "mor_Utts", "mor_Words", "words_min", "Whole_Word_Repetition_percent", "Phonological_fragment_percent", "Phrase_repetitions_percent", "Word_revisions_percent", "Phrase_revisions_percent", "Filled_pauses_percent", "IW_Dur_Utt_Dur", "No_Switch_Dur_Num_No_Switch", "Group")
corr_sub = na.omit(c_sub) # remove rows with NA values
corr_sub = corr_sub[(3:14)]

sub = corr_sub
sub[,1:11] = log(sub[,1:11]+0.01) # log transform + constant to the values
sub # with Group
#corr_matrix <- cor(sub[,1:11], use = "complete.obs")
data.pca <- princomp(scale(sub[,1:11], scale = TRUE, center = TRUE))
summary(data.pca)
```

Check how many patients are left in the dataset and how many participants are in each Aphasia group after removing NA rows.

```{r}
nrow(sub)
table(sub$Group)
```

Below shows the the correlation between each variable and each principal component, for PC1 vs PC2 and PC1 vs PC3:

```{r}
#data.pca$loadings[,1:2] # correlation between each variable and each principal component
library(knitr) # load the knitr package for table formatting
# PC1 vs PC2
loadings_df = as.data.frame(round(data.pca$loadings[,1:2], 2))
rownames(loadings_df) = c("Log Number of Utterances", "Log Number of Words", "Log Words Per Minute", 
                          "Log % Whole Word Repetition", "Log % Phonological Fragment", "Log % Phrase Repetitions", 
                          "Log % Word Revisions", "Log % Phrase Revisions", "Log % Filled Pauses", 
                          "Log Internal Utterance Pause Duration", "Log Between Utterance Pause Duration")
kable(loadings_df, format = "markdown", col.names = c("PC1", "PC2"))

# PC1 vs PC3
loadings_df = as.data.frame(round(data.pca$loadings[,c(1,3)], 2))
rownames(loadings_df) = c("Log Number of Utterances", "Log Number of Words", "Log Words Per Minute", 
                          "Log % Whole Word Repetition", "Log % Phonological Fragment", "Log % Phrase Repetitions", 
                          "Log % Word Revisions", "Log % Phrase Revisions", "Log % Filled Pauses", 
                          "Log Internal Utterance Pause Duration", "Log Between Utterance Pause Duration")
kable(loadings_df, format = "markdown", col.names = c("PC1", "PC3"))

```


Below shows plots of how much variance is captured by each PC, variable PCA, and individual PCA, for PC1 vs PC2 and PC1 vs PC3.

```{r}
library(ggfortify)
library(plotly)
library("factoextra")
# for PC1 vs PC2
plot(data.pca, type="l")
#fviz_pca_biplot(data.pca, repel = TRUE)
fviz_pca_var(data.pca, col.var = "black", axes = c(1,2))
fviz_pca_ind(data.pca, axes = c(1,2))

# for PC1 vs PC3
plot(data.pca, type="l")
#fviz_pca_biplot(data.pca, repel = TRUE)
fviz_pca_var(data.pca, col.var = "black", axes = c(1,3))
fviz_pca_ind(data.pca, axes = c(1,3))
```


Scatter Plot by Aphasia Groups based on PCA results:

```{r}
# PC1 vs PC2
p = autoplot(prcomp(sub[,1:11], center = TRUE, scale = TRUE), data=sub, colour="Group")
ggplotly(p)
# projected = projected points from pcs
projected = prcomp(sub[,1:11], center = TRUE, scale = TRUE)$x[,c(1,2)]

# PC1 vs PC3
p = autoplot(prcomp(sub[,1:11], center = TRUE, scale = TRUE), data=sub, colour="Group", x=1, y=3)
ggplotly(p)
# projected = projected points from pcs
projected2 = prcomp(sub[,1:11], center = TRUE, scale = TRUE)$x[,c(1,3)]


projected = prcomp(sub[,1:11], center = TRUE, scale = TRUE)$x[,c(1,2)]
```


GMM results, based on PC1 vs PC2.

```{r}
library(mclust)
projected = data.frame(projected)
# G specifies the num of groups we want, fit GMM
fit = Mclust(data.frame(projected)[,c(1,2)])
# Plot GMM with no aphasia group labels, does clustering by itself by max probability
#plot(fit, what = "classification")
fviz_mclust(fit, "classification", geom = "point")
# Plot the GMM with aphasia group labels, actual labels
fit$classification = sub$Group
plot(fit, what = "classification")
fviz_mclust(fit, "classification", geom = "point")
#legend("topright", legend = fit$classification)
```

3 is the optimal number of clusters based on BIC.

```{r}
# Plot the GMM with aphasia group labels, actual labels
col = c("red","blue","orange","purple","brown","green")
BICs = unlist(lapply(1:6, function(GVal){
  fit = Mclust(data.frame(projected)[,c(1,2)], G =GVal)
  fit$classification = sub$Group
  plot(fit, what = "classification", col=col)
  legend("bottomright", c("Anomic", "Broca", "Conduction", "control", "NotAphasicByWAB", "Wernicke"),
     col = col, pch = "-", trace=TRUE, cex=0.7)
  return(fit$bic)
}))

plot(1:6, BICs, main="BIC Screeplot", xlab="Num of Clusters", pch=15, col="blue")
lines(1:6, BICs)
```

Above, we tried to see how they are clustered based on the diff num of groups we specify (1 to 6 groups). The scree plot reflects which number of clusters is the most optimal one (highest BIC based on how the library calculates). 

```{r}
# Just for prediction, see which observation belongs to which aphasia group (by probability)
fit2 = MclustDA(sub[,1:11], class = sub$Group)
#plot(fit2, what = "classification")
pred = predict(fit2, newdata = sub[,1:11])
clust_summary = summary(fit2, parameters = TRUE)
# tab gives the confusion matrix
clust_summary$tab
# ce gives classification error (training error)
clust_summary$ce
```

Above gives the confusion matrix and the corresponding classification error.

```{r}
sub$id = seq_along(c(1:nrow(sub)))
predict(fit2, newdata = sub[8,1:11])
```

When we specify which observation we want to look at, the above outputs the probability of predicting each aphasia group. The aphasia group that has the highest probability is the final prediction result. In this case, we tried the 8th patient, which outputs "Anomic", indicating that the patient is most likely identified as having Anomic Aphasia based on GMM.

PCA on the Cat task:
```{r}
variables = c("Age.Month.", "Custom_field", "mor_Utts", "mor_Words", "words_min", "X._Phonological_fragment.1", "X._Phrase_repetitions.1", "X._Word_revisions.1", "X._Phrase_revisions.1", "X._Filled_pauses.1", "IW_Dur.Utt_dur", "No_Switch_Dur.._No_Switch", "Group")
c_sub = subset(cat, select = variables)
colnames(c_sub) = c("Age", "AQ_score", "mor_Utts", "mor_Words", "words_min", "Phonological_fragment_percent", "Phrase_repetitions_percent", "Word_revisions_percent", "Phrase_revisions_percent", "Filled_pauses_percent", "IW_Dur_Utt_Dur", "No_Switch_Dur_Num_No_Switch", "Group")
corr_sub = na.omit(c_sub) # remove rows with NA values
corr_sub = corr_sub[(3:13)]
sub = corr_sub
sub[,1:10] = log(sub[,1:10]+0.01) # log transform + constant to the values
sub # with Group
corr_matrix <- cor(sub[,1:10], use = "complete.obs")
data.pca <- princomp(scale(sub[,1:10], scale = TRUE, center = TRUE))
summary(data.pca)
```

```{r}
data.pca$loadings[,1:2] # correlation between each variable and each principal component
```

```{r}
library(ggfortify)
library(plotly)
library("factoextra")
#biplot(data.pca)
plot(data.pca, type="l")
fviz_pca_biplot(data.pca, repel = TRUE)
fviz_pca_var(data.pca, col.var = "black")
```


```{r}
p = autoplot(prcomp(sub[,1:10], center = TRUE, scale = TRUE), data=sub, colour="Group")
ggplotly(p)
p$sub[,1:10][[1]]$x
projected = prcomp(sub[,1:10], center = TRUE, scale = TRUE)$x
```


Contingency table that calculates the proportion of values = 0, for Cat task.

```{r}
# corr_sub not log transformed, raw data
groups = c("Anomic", "Broca", "Conduction", "control", "NotAphasicByWAB", "Wernicke")
variables = c("mor_Utts", "mor_Words", "words_min", "Phonological_fragment_percent", "Phrase_repetitions_percent", "Word_revisions_percent", "Phrase_revisions_percent", "Filled_pauses_percent", "IW_Dur_Utt_Dur", "No_Switch_Dur_Num_No_Switch")
df = data.frame(matrix(nrow=10, ncol=6))
colnames(df) = groups; rownames(df) = variables
for (j in c(1:6)){
  n = sum(corr_sub$Group == groups[j])
  for (i in c(1:10)){
    # round to 3 decimal digits
    df[i,j] = round(sum(corr_sub[,i] == 0 & corr_sub$Group == groups[j])/n, 3)
  }
}
df
```

One-Way ANOVA Test on the boxplots for Cinderella task, and the Tukey's Honest Significant Difference (HSD) tests to identify specifically which pairs of Aphasia groups had significantly different means in this multiple comparison setting

## % Number of Phrase Repetitions
```{r}
anova_pr = aov(log(X._Phrase_repetitions.1+0.01) ~ factor(Group, levels = levels), data = cinderella)
summary(anova_pr)
```

We reject the null hypothesis and conclude that there is a significant difference in the mean % log phrase repetitions between the aphasia groups.

```{r}
TukeyHSD(anova_pr, order=TRUE)
plot(TukeyHSD(anova_pr), las = 1, cex.axis = 0.3)
```

## % Number of Word Revisions
```{r}
anova_wr = aov(log(X._Word_revisions.1+0.01) ~ Group, data = cinderella)
summary(anova_wr)
```

We reject the null hypothesis and conclude that there is a significant difference in the mean % log word revisions between the aphasia groups.

```{r}
TukeyHSD(anova_wr, order=TRUE)
plot(TukeyHSD(anova_wr), las = 1, cex.axis = 0.3)
```

## % Number of Phrase Revisions
```{r}
anova_prev = aov(log(X._Phrase_revisions.1+0.01) ~ Group, data = cinderella)
summary(anova_prev)
```

We reject the null hypothesis and conclude that there is a significant difference in the mean % log phrase revisions between the aphasia groups.

```{r}
TukeyHSD(anova_prev, order=TRUE)
plot(TukeyHSD(anova_prev), las = 1, cex.axis = 0.3)
```

## % Number of Phonological Fragments
```{r}
anova_pf = aov(log(X._Phonological_fragment.1+0.01) ~ Group, data = cinderella)
summary(anova_pf)
```

We reject the null hypothesis and conclude that there is a significant difference in the mean % log phonological fragments between the aphasia groups.

```{r}
TukeyHSD(anova_pf, order=TRUE)
plot(TukeyHSD(anova_pf), las = 1, cex.axis = 0.3)
```

## % Number of Filled Pauses
```{r}
anova_fp = aov(log(X._Filled_pauses.1+0.01) ~ Group, data = cinderella)
summary(anova_fp)
```

We reject the null hypothesis and conclude that there is a significant difference in the mean % log filled pauses between the aphasia groups.

```{r}
TukeyHSD(anova_fp, order=TRUE)
plot(TukeyHSD(anova_fp), las = 1, cex.axis = 0.3)
```

## % Number of Whole Word Repetition
```{r}
anova_wwr = aov(log(X._WWR.1+0.01) ~ Group, data = cinderella)
summary(anova_wwr)
```

We reject the null hypothesis and conclude that there is a significant difference in the mean % log filled pauses between the aphasia groups.

```{r}
TukeyHSD(anova_wwr, order=TRUE)
plot(TukeyHSD(anova_wwr), las = 1, cex.axis = 0.3)
```

## Internal Utterance Pause Duration
```{r}
anova_iupd = aov(log(IW_Dur.Utt_dur+0.01) ~ Group, data = cinderella)
summary(anova_iupd)
```

We reject the null hypothesis and conclude that there is a significant difference in the mean % log filled pauses between the aphasia groups.

```{r}
TukeyHSD(anova_iupd, order=TRUE)
plot(TukeyHSD(anova_iupd), las = 1, cex.axis = 0.3)
```


## Between Utterance Pause Duration
```{r}
anova_nsdns = aov(log(No_Switch_Dur.._No_Switch+0.01) ~ Group, data = cinderella)
summary(anova_nsdns)
```

We reject the null hypothesis and conclude that there is a significant difference in the mean % log filled pauses between the aphasia groups.

```{r}
TukeyHSD(anova_nsdns, order=TRUE)
plot(TukeyHSD(anova_nsdns), las = 1, cex.axis = 0.3)
```



